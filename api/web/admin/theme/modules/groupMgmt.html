
<style>
	.col-md-4 {
    width: 40%;
}
	.group-td{
		vertical-align: middle;
		overflow: hidden;
		text-overflow: ellipsis;
		text-align:left;
        padding-left:5px; 
	}
	</style>


<!-- BEGIN PAGE HEADER-->
<h3 class="page-title">群组管理</h3>

<div class="page-bar">
	<ul class="page-breadcrumb">
						<li>
<i class="fa fa-home"></i>
<a href="javascript:;" onclick="Group._new()" >创建企业群组</a>
						</li>
					</ul>	
	
	
</div>

<!-- begin upload photo -->
<div style="position: fixed;overflow: hidden;z-index:99999;border: 1px solid #666666;border-radius: 5px;display: none;height: 430px;left: 335px;top: 80px;width: 500px;" show="false" data-backdrop="static" class="selected_pic_box">
        <div style="padding:0px;width:100%;" class="modal-body">
          	<div>
			  <object width="530" height="480" align="middle" codebase="https://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" name="_imageupload" id="_imageupload">
			    <param value="always" name="allowScriptAccess">
			    <!-- flash的地址 -->
			    <param value="images/AvatarEditor.swf" name="movie">    
			    <param value="high" name="quality">    
			    <param value="always" name="allowScriptAccess">	
				  <!-- 传参数的地方 -->  
			    <param value="uploadServerUrl=/register/cavatareditor/saveavatar&defaultImg=1_120.jpg?id=faceid" name="FlashVars">

			    <embed width="530" height="480" type="application/x-shockwave-flash" pluginspage="https://www.adobe.com/shockwave/download/download.cgi?P1_Prod_Version=ShockwaveFlash" flashvars="uploadServerUrl=/register/cavatareditor/saveavatar&defaultImg=1_120.jpg?id=faceid" wmode="opaque" quality="high" src="images/AvatarEditor.swf" name="_imageupload" id="_imageupload" allowscriptaccess="always" allowfullscreen="true" allownetworking="all" style="height: 475px; width: 515px; margin-left: -10px; margin-top: -15px;">
			  	<param name="allowFullScreen" value="true"><param name="AllowNetworking" value="all"></object>
			</div>
        </div>
        <div style="position: relative; background-color: white; margin-top: -90px;" class="modal-footer">
              <img src="/bundles/justsybase/images/loading.gif" style="float:left;width:32px;height:32px;margin-left:20px;display:none;" id="uplod_loading">
          	  <span style="float:left;margin-left:5px;margin-top:4px;color:#006BD9;" class="upload_hint"></span>
          	  <span class="btn btn-default" id="btn_cancel" onclick="Group.window_close();">关&nbsp;&nbsp;闭</span>
          	  <span class="btn btn-primary" id="btn_save" onclick="Group.uploadfile();">确&nbsp;&nbsp;定</span>
          	  
       	</div>
</div>
<!-- end upload photo -->

<div class="portlet box green hide" id="newGroup-dlg">
			<div class="portlet-title">
				<div class="caption">
					<i class="fa fa-gift"></i>创建企业群组
				</div>
				<div class="tools">
					<a class="remove" href="javascript:;" data-original-title="" title="">
					</a>
				</div>
			</div>
			<div class="portlet-body form">
				<!-- BEGIN FORM-->
				<form class="form-horizontal" action="#" id="groupForm">
					<div class="form-body">
						
						<div class="alert alert-danger display-hide" style="display: none;">
							<button data-close="alert" class="close"></button>
							<label></label>
						</div>
						
						<div class="alert alert-success display-hide" style="display: none;">
							<button data-close="alert" class="close"></button>
							<label></label>
						</div>
						<div style="position:absolute;margin-left:40%;z-index:99;">
							<div class="form-group ">
										<label class="control-label col-md-3"></label>
										<div class="col-md-9">
											<div class="fileinput fileinput-new" data-provides="fileinput">
												<div class="fileinput-preview thumbnail"  style="width: 90px; height: 90px;">
									<img style="height: 80px; margin: auto;" src="images/default_group.png" onerror="this.src='images/default_group.png'" id="logo" class="img-responsive" alt="">								
												</div>	
												<div style="margin-top: -12px">
													<button id="btn_logo_upload" type="button" style="width:90px;" class="btn green">上传Logo</button>
												</div>
											</div>
											
										</div>
									</div>
						</div>
						
						<div class="form-group">
							<label class="col-md-3 control-label">群组名称<span class="required" aria-required="true">* </span></label>
							<div class="col-md-4">
								<input type="text" id="group_name" maxlength="20" placeholder="请输入" class="form-control" style="width:50%;" >			
							</div>
						</div>						
						<div class="form-group">
							<label class="col-md-3 control-label">群组描述</label>
							<div class="col-md-4">
								<input type="text" id="group_desc" maxlength="100" placeholder="请输入" class="form-control" style="width:50%;" >			
							</div>
						</div>
						<div class="form-group">
							<label class="col-md-3 control-label">成员上限<span class="required" aria-required="true">* </span></label>
							<div class="col-md-4">
								<div class="input-icon right">
												<i class="fa"></i>
												<input type="text" id="limit" placeholder="请输入" style="width:50%;" value=100 maxlength="3" name="number" class="form-control">
											</div>											
							</div>
						</div>	


						<div class="form-group" style="margin-bottom: 0px;">
							<label class="col-md-3 control-label">允许部门</label>
							<div class="col-md-4">
								<input type="text" readonly="true" class="form-control" name="dept_area_sel" placeholder="请选择部门" id="dept_area_sel">
							</div>
						</div>
						<div class="form-group">
									<label class="col-md-3 control-label">&nbsp;</label>
									<div class="col-md-4">
										<div id="depttree" linkinput="dept_area_sel" class="ztree scroller" style="max-height: 200px; overflow: auto;border:1px solid #eee" data-always-visible="1" data-rail-visible="0"></div>	
									</div>
						</div>
						<div class="form-group" style="margin-bottom: 1px;">
							<label class="col-md-3 control-label">添加人员 </span></label>
							<div class="col-md-4">
								<div class="input-group input-large">
									<input type="text" id="add_staff"  placeholder="请输入手机或邮箱" class="form-control">
	   								<span class="input-group-btn">
										<button class="btn green" id="btn_search_staff" style="display: inline;position: relative;" onclick="Group.addStaffList(this);" type="button">添加</button>
									</span>
								</div>
							</div>
						</div>
						<div class="form-group">
							<label class="col-md-3 control-label"></label>
							<div class="col-md-4">
								<div id="staff_area_sel"  class="portlet-body" style="border: 1px solid #dddddd;height: 100px; overflow: auto;padding: 0px;" ></div>				
							</div>
						</div>	
						
						<div class="form-actions">
						<div class="row">
							<div class="col-md-offset-3 col-md-9">
								<button class="btn blue" type="button" onclick="Group.save()">保存</button>
								<button class="btn default" type="button" onclick="$('#newGroup-form').remove()">取消</button>
							</div>
						</div>
					</div>

					</div>
				</form>
				
				<!-- END FORM-->
			</div>
	
</div>
<!-- END PAGE HEADER-->
<div class="clearfix"></div>

<div class="row">
	<div class=" col-md-12 tab-content">
		
		<div class="table-responsive">
				<table style="table-layout: fixed;width:100%;" class="table table-striped table-bordered table-advance table-hover" id="groupList">
				<thead>
				<tr>
					<th >
						 群组名称
					</th>
					<th style="width:8%;">
						 群组类型
					</th>
					<th style="width:8%;">
						 成员数量
					</th>
					<th style="width:9%;">
						 最大成员数
					</th>
					<th style="width:12%;">
						 最后发言时间
					</th>
					<th style="width:15%;">
						 群组管理员
					</th>
				
				<th style="width:16%;">
						 群组管理
					</th>
				</tr>
				</thead>
				<tbody>
				
				
				</tbody>
				</table>
		</div>
		
		
		
	<div id="Pagination">
        </div>
</div>
</div>


<!-- 查看部门人员列表 开始 -->
	<div class="col-md-6 hide" style="padding-left: 0;position: absolute;width: 560px;z-index: 99;" id="group-staff-model">
					<!-- BEGIN SAMPLE TABLE PORTLET-->
					<div class="portlet box green">
						<div class="portlet-title">
							<div class="caption">
								<i class="fa fa-cogs"></i>群组成员
							</div>
							<div class="tools">
								<a href="javascript:;" class="remove" data-original-title="" title="">
								</a>
							</div>
						</div>
						<div class="portlet-body" >
							<div class="alert alert-danger display-hide" id="group-alert-danger" style="display: none;">
							<button data-close="alert" class="close"></button>
							<label></label>
						</div>
						
						<div class="alert alert-success display-hide" id="group-alert-success" style="display: none;">
							<button data-close="alert" class="close"></button>
							<label></label>
						</div>
							<div class="table-scrollable">
								<table class="table table-condensed table-hover" style="table-layout:fixed; height: auto;overflow: scroll;" id="group-staff-grid">
								<thead>
									<tr>
										<th  style="width:45px;">
											
										</th>
										<th>
											昵称
										</th>
										<th>
											职务
										</th>
										<th>
											手机
										</th>
										<th>
											操作
										</th>
									</tr>
								</thead>	
								<tbody>
								
								</tbody>
								</table>
							</div>

							<div id="Pagination" style="margin-left:5px;text-align: left;"></div>
						</div>
						
						</div>
					</div>

					<!-- END SAMPLE TABLE PORTLET-->
	</div>
<!-- 查看部门人员列表 结束 -->
<script src="jscript/groupMgmt.js" type="text/javascript"></script>
<script>
jQuery(document).ready(function() {
        Group.init();
});
</script>
<!-- BEGIN GOOGLE RECAPTCHA -->


<script type="text/html" id="group-stafflist-tmpl">
 			{{each}}
 				<tr >
					<td class="group-td">
						{{if $value.photo_path==""}}
						<img style="width:32px;height:32px;" src="../assets/admin/pages/media/profile/avatar.png">
						{{else}}
							<img style="width:32px;height:32px;" src="{{$value.photo_path}}">
						
						{{/if}}
					</td>
				
					<td style="width:80px;" account='{{$value.login_account}}' class='group-td fafa_webim_ocs_presence'>
						<div class="text-overflow">{{$value.nick_name}}</div>
					</td>
				
					<td  style="width:80px;" class="group-td">
						{{$value.dept_name}}
					</td>
				
					<td style="width:80px;" class="group-td">
						{{$value.mobile}}
					</td>
					<td style="vertical-align:middle;">
						<a href="javascript:;" class="btn default" onclick="Group.staff.del(this,'{{$value.employeeid}}','{{$value.groupid}}')"> 删除 </a>
					</td>
				</tr>
			{{/each}}
</script>


<script type="text/html" id="grouplist-tmpl">
	{{each data}}
	
	<tr style="vertical-align:middle;">
					<td style="white-space: nowrap;overflow: hidden;text-overflow: ellipsis;">
						<img class='img-rounded' style="margin: 5px;width: 64px;" onerror="this.src='images/default_group.png'" src="{{$value.logo}}">{{$value.groupname}}
					</td>
					<td style="vertical-align:middle;text-align:center;">
					{{if $value.group_type==0}}
					个人群组
					{{else}}
						企业群组
					{{/if}}
						 
					</td>
						<td style="vertical-align:middle;text-align:center;">
						 <a href="javascript:;" onclick="Group.showGroupStaff(this,'{{$value.groupid}}','{{$value.number}}');" >{{$value.number}}</a>
					</td>
					<td style="vertical-align:middle;text-align:center;">
						 {{$value.max_number}}
					</td>
					<td style="vertical-align:middle;text-align:center;">
						 {{$value.last_date}}
					</td>
					<td style="vertical-align:middle;text-align:center;">
						 {{$value.creator}} 
						 
						 {{each $value.manager as val}}
						 <span style="color:red;">
						 {{val}} 
						 </span>
						 {{/each}}
					</td>
					
					<td style="vertical-align:middle;">
					{{if $value.group_type==1}}
						<a href="javascript:;" class="btn purple-plum" onclick="Group.editForm(this,'{{$value.groupid}}')" > 编辑 </a>
					{{/if}}
						<a href="javascript:;" class="btn default" onclick="Group.del(this,'{{$value.groupid}}')"> 删除 </a>
					</td>
					
					
				</tr>				
				
				
			
			{{/each}}
	</script>